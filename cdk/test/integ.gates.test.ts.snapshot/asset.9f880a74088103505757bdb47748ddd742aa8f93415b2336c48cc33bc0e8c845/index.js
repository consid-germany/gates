"use strict";var a=Object.defineProperty;var S=Object.getOwnPropertyDescriptor;var E=Object.getOwnPropertyNames;var R=Object.prototype.hasOwnProperty;var f=(e,r)=>{for(var n in r)a(e,n,{get:r[n],enumerable:!0})},A=(e,r,n,c)=>{if(r&&typeof r=="object"||typeof r=="function")for(let t of E(r))!R.call(e,t)&&t!==n&&a(e,t,{get:()=>r[t],enumerable:!(c=S(r,t))||c.enumerable});return e};var _=e=>A(a({},"__esModule",{value:!0}),e);var N={};f(N,{handler:()=>p});module.exports=_(N);var i=require("@aws-sdk/client-secrets-manager"),I="AWSPENDING",h="AWSCURRENT",o=d("SECRET_ID"),s=d("X_VERIFY_ORIGIN_HEADER_NAME"),u=new i.SecretsManagerClient,p=async e=>{if(e.headers===void 0||!e.headers.hasOwnProperty(s)||e.headers[s]===void 0)return{isAuthorized:!1};let r=await g();if(r!==void 0&&e.headers[s]==r)return{isAuthorized:!0};let n=await l();return n!==void 0&&e.headers[s]==n?{isAuthorized:!0}:{isAuthorized:!1}};async function g(){try{return(await u.send(new i.GetSecretValueCommand({SecretId:o,VersionStage:I}))).SecretString}catch{}}async function l(){try{return(await u.send(new i.GetSecretValueCommand({SecretId:o,VersionStage:h}))).SecretString}catch{}}function d(e){let r=process.env[e];if(!r)throw new Error(`${e} environment variable is not set`);return r}0&&(module.exports={handler});
